{"map":{"version":3,"sources":["static/js/main.df168443.chunk.js"],"names":["this","push","39","module","exports","__webpack_require__","44","73","76","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","toConsumableArray","defineProperty","objectSpread2","classCallCheck","createClass","inherits","createSuper","lib","lib_default","components_video","_Component","Object","Video","_super","props","_this","call","state","key","value","videoStream","video","srcObject","nextProps","console","log","_this2","a","createElement","style","frameStyle","id","muted","autoPlay","videoStyles","ref","_ref","components_Video","videos","Videos","rVideos","remoteStreams","_rVideos","map","rVideo","index","stream","width","float","padding","cursor","objectFit","borderRadius","name","onClick","switchVideo","display","setState","zIndex","position","backgroundColor","maxHeight","top","right","left","bottom","overflowX","whiteSpace","src_App","App","getLocalStream","navigator","mediaDevices","getUserMedia","audio","options","mirror","then","window","localStream","toggleAudioMute","audioTracks","getAudioTracks","length","i","enabled","whoisOnline","catch","e","sendToPeer","local","socket","messageType","payload","socketID","emit","createPeerConnection","callback","pc","RTCPeerConnection","pc_config","peerConnections","onicecandidate","candidate","remote","oniceconnectionstatechange","ontrack","remoteVideo","streams","prevState","remoteStream","selectedVideo","filter","concat","close","addStream","componentDidMount","connect","path","query","on","data","success","status","peerCount","createOffer","sdpConstraints","sdp","setLocalDescription","setRemoteDescription","RTCSessionDescription","createAnswer","addIceCandidate","RTCIceCandidate","_video","mute","iceServers","urls","credential","username","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","statusText","color","height","margin","minWidth","minHeight","onMouseDown","onMouseUp","Boolean","location","hostname","match","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","error","message"],"mappings":"CAACA,KAAK,6BAA+BA,KAAK,8BAAgC,IAAIC,KAAK,CAAC,CAAC,GAAG,CAElFC,GACA,SAAUC,EAAQC,EAASC,GAEjCF,EAAOC,QAAUC,EAAoB,KAK/BC,GACA,SAAUH,EAAQC,EAASC,KAM3BE,GACA,SAAUJ,EAAQC,KAMlBI,GACA,SAAUL,EAAQM,EAAqBJ,GAE7C,aAEAA,EAAoBK,EAAED,GAGtB,IAAIE,EAAQN,EAAoB,GAC5BO,EAA6BP,EAAoBQ,EAAEF,GAGnDG,EAAYT,EAAoB,IAChCU,EAAiCV,EAAoBQ,EAAEC,GAMvDE,GAHMX,EAAoB,IAGNA,EAAoB,KAGxCY,EAAiBZ,EAAoB,IAGrCa,EAAgBb,EAAoB,GAGpCc,EAAiBd,EAAoB,GAGrCe,EAAcf,EAAoB,GAGlCgB,EAAWhB,EAAoB,GAG/BiB,EAAcjB,EAAoB,GAGlCkB,EAAMlB,EAAoB,IAC1BmB,EAA2BnB,EAAoBQ,EAAEU,GAImEE,EAD3F,SAASC,GAAYC,OAAON,EAA0B,EAAjCM,CAAoCC,EAAMF,GAAY,IAAIG,EAAOF,OAAOL,EAA6B,EAApCK,CAAuCC,GAAO,SAASA,EAAME,GAAO,IAAIC,EAAyG,OAAnGJ,OAAOR,EAAgC,EAAvCQ,CAA0C3B,KAAK4B,IAAOG,EAAMF,EAAOG,KAAKhC,KAAK8B,IAAaG,MAAM,GAAUF,EACvP,OAD8PJ,OAAOP,EAA6B,EAApCO,CAAuCC,EAAM,CAAC,CAACM,IAAI,oBAAoBC,MAAM,WAAgCnC,KAAK8B,MAAMM,cAAapC,KAAKqC,MAAMC,UAAUtC,KAAK8B,MAAMM,eAAgB,CAACF,IAAI,4BAA4BC,MAAM,SAAmCI,GAAWC,QAAQC,IAAIF,EAAUH,aAAgBG,EAAUH,aAAaG,EAAUH,cAAcpC,KAAK8B,MAAMM,cAAapC,KAAKqC,MAAMC,UAAUC,EAAUH,eAAgB,CAACF,IAAI,SAASC,MAAM,WAAkB,IAAIO,EAAO1C,KAAK,OAAmBY,EAAc+B,EAAEC,cAAc,MAAM,CAACC,MAAMlB,OAAOT,EAA+B,EAAtCS,CAAyC,GAAG3B,KAAK8B,MAAMgB,aAA0BlC,EAAc+B,EAAEC,cAAc,QAAQ,CAACG,GAAG/C,KAAK8B,MAAMiB,GAAGC,MAAMhD,KAAK8B,MAAMkB,MAAMC,UAAS,EAAKJ,MAAMlB,OAAOT,EAA+B,EAAtCS,CAAyC,GAAG3B,KAAK8B,MAAMoB,aACtjCC,IAAI,SAAaC,GAAMV,EAAOL,MAAMe,UAAsBxB,EAD9B,CACsCjB,EAAiB,WAGoC0C,EAD3F,SAAS3B,GAAYC,OAAON,EAA0B,EAAjCM,CAAoCC,EAAMF,GAAY,IAAIG,EAAOF,OAAOL,EAA6B,EAApCK,CAAuCC,GAAO,SAASA,EAAME,GAAO,IAAIC,EAAyG,OAAnGJ,OAAOR,EAAgC,EAAvCQ,CAA0C3B,KAAK4B,IAAOG,EAAMF,EAAOG,KAAKhC,KAAK8B,IAAaG,MAAM,GAAUF,EACvP,OAD8PJ,OAAOP,EAA6B,EAApCO,CAAuCC,EAAM,CAAC,CAACM,IAAI,oBAAoBC,MAAM,WAAgCnC,KAAK8B,MAAMM,cAAapC,KAAKqC,MAAMC,UAAUtC,KAAK8B,MAAMM,eAAgB,CAACF,IAAI,4BAA4BC,MAAM,SAAmCI,GAAWC,QAAQC,IAAIF,EAAUH,aAAgBG,EAAUH,aAAaG,EAAUH,cAAcpC,KAAK8B,MAAMM,cAAapC,KAAKqC,MAAMC,UAAUC,EAAUH,eAAgB,CAACF,IAAI,SAASC,MAAM,WAAkB,IAAIO,EAAO1C,KAAK,OAAmBY,EAAc+B,EAAEC,cAAc,MAAM,CAACC,MAAMlB,OAAOT,EAA+B,EAAtCS,CAAyC,GAAG3B,KAAK8B,MAAMgB,aAA0BlC,EAAc+B,EAAEC,cAAc,QAAQ,CAACG,GAAG/C,KAAK8B,MAAMiB,GAAGC,MAAMhD,KAAK8B,MAAMkB,MAAMC,UAAS,EAAKJ,MAAMlB,OAAOT,EAA+B,EAAtCS,CAAyC,GAAG3B,KAAK8B,MAAMoB,aACtjCC,IAAI,SAAaC,GAAMV,EAAOL,MAAMe,UAAsBxB,EAD9B,CACsCjB,EAAiB,WAEw2C2C,EAA75C,SAAS5B,GAAYC,OAAON,EAA0B,EAAjCM,CAAoC4B,EAAO7B,GAAY,IAAIG,EAAOF,OAAOL,EAA6B,EAApCK,CAAuC4B,GAAQ,SAASA,EAAOzB,GAAO,IAAIC,EAAqI,OAA/HJ,OAAOR,EAAgC,EAAvCQ,CAA0C3B,KAAKuD,IAAQxB,EAAMF,EAAOG,KAAKhC,KAAK8B,IAAaG,MAAM,CAACuB,QAAQ,GAAGC,cAAc,IAAW1B,EAA2iC,OAApiCJ,OAAOP,EAA6B,EAApCO,CAAuC4B,EAAO,CAAC,CAACrB,IAAI,4BAA4BC,MAAM,SAAmCI,GAAW,IAAIG,EAAO1C,KAAK,GAAGA,KAAK8B,MAAM2B,gBAAgBlB,EAAUkB,cAAc,CAAC,IAAIC,EAASnB,EAAUkB,cAAcE,KAAI,SAASC,EAAOC,GAAO,IAAIxB,EAAmBzB,EAAc+B,EAAEC,cAAcS,EAAiB,CAACjB,YAAYwB,EAAOE,OAAOhB,WAAW,CAACiB,MAAM,IAAIC,MAAM,OAAOC,QAAQ,SAASf,YAAY,CAACgB,OAAO,UAAUC,UAAU,QAAQC,aAAa,EAAEL,MAAM,UAAU,OAAmBnD,EAAc+B,EAAEC,cAAc,MAAM,CAACG,GAAGa,EAAOS,KAAKC,QAAQ,WAAmB,OAAO5B,EAAOZ,MAAMyC,YAAYX,IAAUf,MAAM,CAAC2B,QAAQ,gBAAgBtC,IAAI2B,GAAOxB,MAAUrC,KAAKyE,SAAS,CAAChB,cAAclB,EAAUkB,cAAcD,QAAQE,OAAe,CAACxB,IAAI,SAASC,MAAM,WAAkB,OAAmBvB,EAAc+B,EAAEC,cAAc,MAAM,CAACC,MAAM,CAAC6B,OAAO,EAAEC,SAAS,QAAQV,QAAQ,UAAUW,gBAAgB,kBAAkBC,UAAU,IAAIC,IAAI,OAAOC,MAAM,GAAGC,KAAK,GAAGC,OAAO,GAAGC,UAAU,SAASC,WAAW,WAAWnF,KAAKiC,MAAMuB,aAAqBD,EAA/1C,CAAw2C5C,EAAiB,WA6CxlByE,EA3CvyB,SAAS1D,GAAYC,OAAON,EAA0B,EAAjCM,CAAoC0D,EAAI3D,GAAY,IAAIG,EAAOF,OAAOL,EAA6B,EAApCK,CAAuC0D,GAAK,SAASA,EAAIvD,GAAO,IAAIC,EAuCjL,OAvCuLJ,OAAOR,EAAgC,EAAvCQ,CAA0C3B,KAAKqF,IAAKtD,EAAMF,EAAOG,KAAKhC,KAAK8B,IAAawD,eAAe,WAkB9RC,UAAUC,aAAaC,aARP,CAACC,OAAM,EAAKrD,OAAM,EAOlCsD,QAAQ,CAACC,QAAO,KACiCC,MAhBrC,SAAiB/B,GAAQgC,OAAOC,YAAYjC,EAAO/B,EAAM0C,SAAS,CAACsB,YAAYjC,IAK3FkC,gBAAgB,WAA2B,IAAIC,EAAYlE,EAAMgE,YAAYG,iBAAiB,GAAwB,IAArBD,EAAYE,OAA6C,IAAI,IAAIC,EAAE,EAAEA,EAAEH,EAAYE,SAASC,EAAGH,EAAYG,GAAGC,SAASJ,EAAYG,GAAGC,aAA9G7D,QAAQC,IAAI,cAA6GV,EAAMuE,iBAWzLC,OAVnD,SAAiBC,GAAGhE,QAAQC,IAAI,uBAAuB+D,OAUazE,EAAMuE,YAAY,WAClGvE,EAAM0E,WAAW,cAAc,KAAK,CAACC,MAAM3E,EAAM4E,OAAO5D,MAAOhB,EAAM0E,WAAW,SAASG,EAAYC,EAAQC,GAAU/E,EAAM4E,OAAOI,KAAKH,EAAY,CAACE,SAASA,EAASD,QAAQA,KAAY9E,EAAMiF,qBAAqB,SAASF,EAASG,GAAU,IAAI,IAAIC,EAAG,IAAIC,kBAAkBpF,EAAME,MAAMmF,WAC5RC,EAAgB1F,OAAOT,EAA+B,EAAtCS,CAAyCA,OAAOT,EAA+B,EAAtCS,CAAyC,GAAGI,EAAME,MAAMoF,iBAAiB,GAAG1F,OAAOV,EAAgC,EAAvCU,CAA0C,GAAGmF,EAASI,IAAKnF,EAAM0C,SAAS,CAAC4C,gBAAgBA,IAAkBH,EAAGI,eAAe,SAASd,GAAMA,EAAEe,WAAWxF,EAAM0E,WAAW,YAAYD,EAAEe,UAAU,CAACb,MAAM3E,EAAM4E,OAAO5D,GAAGyE,OAAOV,KAAcI,EAAGO,2BAA2B,SAASjB,KAAKU,EAAGQ,QAAQ,SAASlB,GAAG,IAAImB,EAAY,CAAC5E,GAAG+D,EAASzC,KAAKyC,EAAShD,OAAO0C,EAAEoB,QAAQ,IAAI7F,EAAM0C,UAAS,SAASoD,GACphB,IAAIC,EAAaD,EAAUpE,cAAc0C,OAAO,EAAE,GAAG,CAAC2B,aAAatB,EAAEoB,QAAQ,IACzEG,EAAcF,EAAUpE,cAAcuE,QAAO,SAASlE,GAAQ,OAAOA,EAAOf,KAAK8E,EAAUE,cAAchF,MAC3C,OAAlEgF,EAAcA,EAAc5B,OAAO,GAAG,CAAC4B,cAAcJ,GAAoBhG,OAAOT,EAA+B,EAAtCS,CAAyCA,OAAOT,EAA+B,EAAtCS,CAAyCA,OAAOT,EAA+B,EAAtCS,CAAyC,GAAGoG,GAAeD,GAAc,GAAG,CAACrE,cAAc,GAAGwE,OAAOtG,OAAOX,EAAmC,EAA1CW,CAA6CkG,EAAUpE,eAAe,CAACkE,UAAqBT,EAAGgB,MAAM,aAChWnG,EAAME,MAAM8D,aAAYmB,EAAGiB,UAAUpG,EAAME,MAAM8D,aACtDkB,EAASC,GAAK,MAAMV,GAAGhE,QAAQC,IAAI,yCAAyC+D,GAC5ES,EAAS,QAASlF,EAAMqG,kBAAkB,WAAWrG,EAAM4E,OAAOnF,EAAYmB,EAAE0F,QAAQ,uCAAuC,CAACC,KAAK,oBAAoBC,MAAM,KAAKxG,EAAM4E,OAAO6B,GAAG,sBAAqB,SAASC,GAAM1G,EAAMuD,iBAAiB9C,QAAQC,IAAIgG,EAAKC,SAAS,IAAIC,EAAOF,EAAKG,UAAU,EAAE,0BAA0BX,OAAOQ,EAAKG,WAAW,qCAAqC7G,EAAM0C,SAAS,CAACkE,OAAOA,OAAY5G,EAAM4E,OAAO6B,GAAG,qBAAoB,SAASC,GAAMjG,QAAQC,IAAI,oBAAoBgG,GAAM,IAAIhF,EAAc1B,EAAME,MAAMwB,cAAcuE,QAAO,SAASlE,GAAQ,OAAOA,EAAOf,KAAK0F,EAAK3B,YAAY/E,EAAM0C,UAAS,SAASoD,GACvnB,IAAIE,EAAcF,EAAUE,cAAchF,KAAK0F,EAAK3B,UAAUrD,EAAc0C,OAAO,CAAC4B,cAActE,EAAc,IAAI,KAAK,OAAO9B,OAAOT,EAA+B,EAAtCS,CAAyC,CACzK8B,cAAcA,GAAesE,SAAqBhG,EAAM4E,OAAO6B,GAAG,eAAc,SAAS1B,GAAUtE,QAAQC,IAAI,sBAAsBqE,GAErI/E,EAAMiF,qBAAqBF,GAAS,SAASI,GAC1CA,GAAGA,EAAG2B,YAAY9G,EAAME,MAAM6G,gBAAgBjD,MAAK,SAASkD,GAAK7B,EAAG8B,oBAAoBD,GAAKhH,EAAM0E,WAAW,QAAQsC,EAAI,CAACrC,MAAM3E,EAAM4E,OAAO5D,GAAGyE,OAAOV,aAAoB/E,EAAM4E,OAAO6B,GAAG,SAAQ,SAASC,GAAM1G,EAAMiF,qBAAqByB,EAAK3B,UAAS,SAASI,GAAIA,EAAGiB,UAAUpG,EAAME,MAAM8D,aAAamB,EAAG+B,qBAAqB,IAAIC,sBAAsBT,EAAKM,MAAMlD,MAAK,WACpXqB,EAAGiC,aAAapH,EAAME,MAAM6G,gBAAgBjD,MAAK,SAASkD,GAAK7B,EAAG8B,oBAAoBD,GAAKhH,EAAM0E,WAAW,SAASsC,EAAI,CAACrC,MAAM3E,EAAM4E,OAAO5D,GAAGyE,OAAOiB,EAAK3B,uBAAuB/E,EAAM4E,OAAO6B,GAAG,UAAS,SAASC,GACrN,IAAIvB,EAAGnF,EAAME,MAAMoF,gBAAgBoB,EAAK3B,UAAUtE,QAAQC,IAAIgG,EAAKM,KAAK7B,EAAG+B,qBAAqB,IAAIC,sBAAsBT,EAAKM,MAAMlD,MAAK,kBAAiB9D,EAAM4E,OAAO6B,GAAG,aAAY,SAASC,GAChM,IAAIvB,EAAGnF,EAAME,MAAMoF,gBAAgBoB,EAAK3B,UAAaI,GAAGA,EAAGkC,gBAAgB,IAAIC,gBAAgBZ,EAAKlB,gBAAiBxF,EAAMwC,YAAY,SAAS+E,GAAQ9G,QAAQC,IAAI6G,GAAQvH,EAAM0C,SAAS,CAACsD,cAAcuB,KAAWvH,EAAME,MAAM,CAAC8D,YAAY,KAC9O+B,aAAa,KACbyB,MAAK,EAAM9F,cAAc,GACzB4D,gBAAgB,GAChBU,cAAc,KAAKY,OAAO,iBAAiBvB,UAAU,CAACoC,WAAW,CAAC,CAACC,KAAK,wBAAwBC,WAAW,kBAAkBC,SAAS,mBAAmB,CAACF,KAAK,kCAAkCX,eAAe,CAACc,UAAU,CAACC,qBAAoB,EAAKC,qBAAoB,KAAQ/H,EAAM4E,OAAO,KACvR5E,EAIuvB,OAJhvBJ,OAAOP,EAA6B,EAApCO,CAAuC0D,EAAI,CAAC,CAACnD,IAAI,SAASC,MAAM,WAC9E,IAAI4H,EAAwBnJ,EAAc+B,EAAEC,cAAc,MAAM,CAACC,MAAM,CAACmH,MAAM,SAAS/F,QAAQ,IAAIjE,KAAKiC,MAAM0G,QAAQ,OAAmB/H,EAAc+B,EAAEC,cAAc,MAAM,KAAkBhC,EAAc+B,EAAEC,cAAcnB,EAAiB,CAACyB,YAAY,CAACwB,OAAO,EAAEC,SAAS,WAAWI,MAAM,EAAEhB,MAAM,IAAIkG,OAAO,IAAIC,OAAO,EAAEtF,gBAAgB,SAC9UxC,YAAYpC,KAAKiC,MAAM8D,YAAY9C,UAAS,EAAKD,OAAM,IAAoBpC,EAAc+B,EAAEC,cAAcnB,EAAiB,CAACyB,YAAY,CAACwB,OAAO,EAAEC,SAAS,QAAQM,OAAO,EAAEkF,SAAS,OAAOC,UAAU,OAAOxF,gBAAgB,SAC5NxC,YAAYpC,KAAKiC,MAAM8F,eAAe/H,KAAKiC,MAAM8F,cAAcjE,OAAOb,UAAS,IAChErC,EAAc+B,EAAEC,cAAc,KAAK,MAAmBhC,EAAc+B,EAAEC,cAAc,MAAM,CAACC,MAAM,CAAC6B,OAAO,EAAEC,SAAS,WAAWuF,OAAO,GAAGtF,gBAAgB,YAAYX,QAAQ,GAAGG,aAAa,IAAI2F,GAAyBnJ,EAAc+B,EAAEC,cAAc,MAAM,CAACC,MAAM,CAAC6B,OAAO,EAAEC,SAAS,WAAWuF,OAAO,GAAGnF,MAAM,GAAGE,OAAO,MAAmBrE,EAAc+B,EAAEC,cAAc,SAAS,CAACyH,YAAY,WAAuB,OAAOrE,mBAAoBsE,UAAU,WAAqB,OAAOtE,oBAAqB,iBAA8BpF,EAAc+B,EAAEC,cAAc,MAAM,KAAkBhC,EAAc+B,EAAEC,cAAcU,EAAO,CAACiB,YAAYvE,KAAKuE,YAAYd,cAAczD,KAAKiC,MAAMwB,iBAA8B7C,EAAc+B,EAAEC,cAAc,KAAK,WAAmByC,EA3C5uB,CA2CkvB1E,EAAiB,WAW5wB4J,QAAmC,cAA3BzE,OAAO0E,SAASC,UACb,UAA3B3E,OAAO0E,SAASC,UAChB3E,OAAO0E,SAASC,SAASC,MAAM,2DAsB/B3J,EAAkB4B,EAAEgI,OAAoB/J,EAAc+B,EAAEC,cAAchC,EAAc+B,EAAEiI,WAAW,KAAkBhK,EAAc+B,EAAEC,cAAcwC,EAAQ,OAAOyF,SAASC,eAAe,SAF3B,kBAAkBvF,WAAWA,UAAUwF,cAAcC,MAAMnF,MAAK,SAASoF,GAAcA,EAAaC,gBAAgB3E,OAAM,SAAS4E,GAAO3I,QAAQ2I,MAAMA,EAAMC,cASzT,CAAC,CAAC,GAAG,EAAE"},"code":"(this[\"webpackJsonpweb-rtc-audio\"]=this[\"webpackJsonpweb-rtc-audio\"]||[]).push([[0],{39:function(e,t,o){e.exports=o(76)},44:function(e,t,o){},73:function(e,t){},76:function(e,t,o){\"use strict\";o.r(t);var n=o(0),a=o.n(n),r=o(36),i=o.n(r),c=(o(44),o(38)),s=o(11),l=o(1),d=o(2),u=o(3),m=o(5),p=o(4),f=o(37),v=o.n(f),h=function(e){Object(m.a)(o,e);var t=Object(p.a)(o);function o(e){var n;return Object(d.a)(this,o),(n=t.call(this,e)).state={},n}return Object(u.a)(o,[{key:\"componentDidMount\",value:function(){this.props.videoStream&&(this.video.srcObject=this.props.videoStream)}},{key:\"componentWillReceiveProps\",value:function(e){console.log(e.videoStream),e.videoStream&&e.videoStream!==this.props.videoStream&&(this.video.srcObject=e.videoStream)}},{key:\"render\",value:function(){var e=this;return a.a.createElement(\"div\",{style:Object(l.a)({},this.props.frameStyle)},a.a.createElement(\"video\",{id:this.props.id,muted:this.props.muted,autoPlay:!0,style:Object(l.a)({},this.props.videoStyles),ref:function(t){e.video=t}}))}}]),o}(n.Component),S=function(e){Object(m.a)(o,e);var t=Object(p.a)(o);function o(e){var n;return Object(d.a)(this,o),(n=t.call(this,e)).state={},n}return Object(u.a)(o,[{key:\"componentDidMount\",value:function(){this.props.videoStream&&(this.video.srcObject=this.props.videoStream)}},{key:\"componentWillReceiveProps\",value:function(e){console.log(e.videoStream),e.videoStream&&e.videoStream!==this.props.videoStream&&(this.video.srcObject=e.videoStream)}},{key:\"render\",value:function(){var e=this;return a.a.createElement(\"div\",{style:Object(l.a)({},this.props.frameStyle)},a.a.createElement(\"video\",{id:this.props.id,muted:this.props.muted,autoPlay:!0,style:Object(l.a)({},this.props.videoStyles),ref:function(t){e.video=t}}))}}]),o}(n.Component),b=function(e){Object(m.a)(o,e);var t=Object(p.a)(o);function o(e){var n;return Object(d.a)(this,o),(n=t.call(this,e)).state={rVideos:[],remoteStreams:[]},n}return Object(u.a)(o,[{key:\"componentWillReceiveProps\",value:function(e){var t=this;if(this.props.remoteStreams!==e.remoteStreams){var o=e.remoteStreams.map((function(e,o){var n=a.a.createElement(S,{videoStream:e.stream,frameStyle:{width:120,float:\"left\",padding:\"0 3px\"},videoStyles:{cursor:\"pointer\",objectFit:\"cover\",borderRadius:3,width:\"100%\"}});return a.a.createElement(\"div\",{id:e.name,onClick:function(){return t.props.switchVideo(e)},style:{display:\"inline-block\"},key:o},n)}));this.setState({remoteStreams:e.remoteStreams,rVideos:o})}}},{key:\"render\",value:function(){return a.a.createElement(\"div\",{style:{zIndex:3,position:\"fixed\",padding:\"6px 3px\",backgroundColor:\"rgba(0,0,0,0.3)\",maxHeight:120,top:\"auto\",right:10,left:10,bottom:10,overflowX:\"scroll\",whiteSpace:\"nowrap\"}},this.state.rVideos)}}]),o}(n.Component),g=function(e){Object(m.a)(o,e);var t=Object(p.a)(o);function o(e){var n;return Object(d.a)(this,o),(n=t.call(this,e)).getLocalStream=function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!0,options:{mirror:!0}}).then((function(e){window.localStream=e,n.setState({localStream:e}),toggleAudioMute=function(){var e=n.localStream.getAudioTracks();if(0!==e.length)for(var t=0;t<e.length;++t)e[t].enabled=!e[t].enabled;else console.log(\"No audio.\")},n.whoisOnline()})).catch((function(e){console.log(\"getUserMedia Error: \",e)}))},n.whoisOnline=function(){n.sendToPeer(\"onlinePeers\",null,{local:n.socket.id})},n.sendToPeer=function(e,t,o){n.socket.emit(e,{socketID:o,payload:t})},n.createPeerConnection=function(e,t){try{var o=new RTCPeerConnection(n.state.pc_config),a=Object(l.a)(Object(l.a)({},n.state.peerConnections),{},Object(s.a)({},e,o));n.setState({peerConnections:a}),o.onicecandidate=function(t){t.candidate&&n.sendToPeer(\"candidate\",t.candidate,{local:n.socket.id,remote:e})},o.oniceconnectionstatechange=function(e){},o.ontrack=function(t){var o={id:e,name:e,stream:t.streams[0]};n.setState((function(e){var n=e.remoteStreams.length>0?{}:{remoteStream:t.streams[0]},a=e.remoteStreams.filter((function(t){return t.id===e.selectedVideo.id}));return a=a.length?{}:{selectedVideo:o},Object(l.a)(Object(l.a)(Object(l.a)({},a),n),{},{remoteStreams:[].concat(Object(c.a)(e.remoteStreams),[o])})}))},o.close=function(){},n.state.localStream&&o.addStream(n.state.localStream),t(o)}catch(r){console.log(\"Something went wrong! pc not created!!\",r),t(null)}},n.componentDidMount=function(){n.socket=v.a.connect(\"https://20bb5aa6.ngrok.io/webrtcPeer\",{path:\"/io/web-rtc-audio\",query:{}}),n.socket.on(\"connection-success\",(function(e){n.getLocalStream(),console.log(e.success);var t=e.peerCount>1?\"Total Connected Peers: \".concat(e.peerCount):\"Waiting for other peers to connect\";n.setState({status:t})})),n.socket.on(\"peer-disconnected\",(function(e){console.log(\"peer-disconnected\",e);var t=n.state.remoteStreams.filter((function(t){return t.id!==e.socketID}));n.setState((function(o){var n=o.selectedVideo.id===e.socketID&&t.length?{selectedVideo:t[0]}:null;return Object(l.a)({remoteStreams:t},n)}))})),n.socket.on(\"online-peer\",(function(e){console.log(\"connected peers ...\",e),n.createPeerConnection(e,(function(t){t&&t.createOffer(n.state.sdpConstraints).then((function(o){t.setLocalDescription(o),n.sendToPeer(\"offer\",o,{local:n.socket.id,remote:e})}))}))})),n.socket.on(\"offer\",(function(e){n.createPeerConnection(e.socketID,(function(t){t.addStream(n.state.localStream),t.setRemoteDescription(new RTCSessionDescription(e.sdp)).then((function(){t.createAnswer(n.state.sdpConstraints).then((function(o){t.setLocalDescription(o),n.sendToPeer(\"answer\",o,{local:n.socket.id,remote:e.socketID})}))}))}))})),n.socket.on(\"answer\",(function(e){var t=n.state.peerConnections[e.socketID];console.log(e.sdp),t.setRemoteDescription(new RTCSessionDescription(e.sdp)).then((function(){}))})),n.socket.on(\"candidate\",(function(e){var t=n.state.peerConnections[e.socketID];t&&t.addIceCandidate(new RTCIceCandidate(e.candidate))}))},n.switchVideo=function(e){console.log(e),n.setState({selectedVideo:e})},n.state={localStream:null,remoteStream:null,mute:!1,remoteStreams:[],peerConnections:{},selectedVideo:null,status:\"Please wait...\",pc_config:{iceServers:[{urls:\"turn:numb.viagenie.ca\",credential:\"@DGSTSj5mJukHRC\",username:\"sam2323@azet.sk\"},{urls:\"stun:stun.l.google.com:19302\"}]},sdpConstraints:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}}},n.socket=null,n}return Object(u.a)(o,[{key:\"render\",value:function(){var e=a.a.createElement(\"div\",{style:{color:\"yellow\",padding:5}},this.state.status);return a.a.createElement(\"div\",null,a.a.createElement(h,{videoStyles:{zIndex:2,position:\"absolute\",right:0,width:200,height:200,margin:5,backgroundColor:\"black\"},videoStream:this.state.localStream,autoPlay:!0,muted:!0}),a.a.createElement(h,{videoStyles:{zIndex:1,position:\"fixed\",bottom:0,minWidth:\"100%\",minHeight:\"100%\",backgroundColor:\"black\"},videoStream:this.state.selectedVideo&&this.state.selectedVideo.stream,autoPlay:!0}),a.a.createElement(\"br\",null),a.a.createElement(\"div\",{style:{zIndex:3,position:\"absolute\",margin:10,backgroundColor:\"#cdc4ff4f\",padding:10,borderRadius:5}},e),a.a.createElement(\"div\",{style:{zIndex:5,position:\"absolute\",margin:10,right:10,bottom:120}},a.a.createElement(\"button\",{onMouseDown:function(){return toggleAudioMute()},onMouseUp:function(){return toggleAudioMute()}},\"Push to talk\")),a.a.createElement(\"div\",null,a.a.createElement(b,{switchVideo:this.switchVideo,remoteStreams:this.state.remoteStreams})),a.a.createElement(\"br\",null))}}]),o}(n.Component);Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(g,null)),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[39,1,2]]]);","extractedComments":[]}