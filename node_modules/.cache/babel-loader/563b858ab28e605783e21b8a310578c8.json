{"ast":null,"code":"var _jsxFileName = \"/Users/samuelhancak/Documents/WebRTC/web-rtc-audio/src/PeerConnection.jsx\";\nimport React from \"react\";\nimport \"webrtc-adapter\"; // copied from common.js https://github.com/webrtc/samples/blob/gh-pages/src/js/common.js\n\nfunction trace(arg) {\n  var now = (window.performance.now() / 1000).toFixed(3);\n  console.log(now + \": \", arg);\n}\n\nclass PeerConnection extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      startDisabled: false,\n      callDisabled: true,\n      hangUpDisabled: true,\n      servers: null,\n      pc1: null,\n      pc2: null,\n      localStream: null\n    };\n    this.localVideoRef = React.createRef();\n    this.remoteVideoRef = React.createRef();\n\n    this.start = () => {\n      this.setState({\n        startDisabled: true\n      });\n      navigator.mediaDevices.getUserMedia({\n        audio: true,\n        video: true\n      }).then(this.gotStream).catch(e => alert(\"getUserMedia() error:\" + e.name));\n    };\n\n    this.gotStream = stream => {\n      this.localVideoRef.current.srcObject = stream;\n      this.setState({\n        callDisabled: false,\n        localStream: stream\n      });\n    };\n\n    this.gotRemoteStream = event => {\n      let remoteVideo = this.remoteVideoRef.current;\n\n      if (remoteVideo.srcObject !== event.streams[0]) {\n        remoteVideo.srcObject = event.streams[0];\n      }\n    };\n\n    this.call = () => {\n      this.setState({\n        callDisabled: true,\n        hangUpDisabled: false\n      });\n      let {\n        localStream\n      } = this.state; // Ah, servers needs to be some sort of iceServer thing\n      // https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer\n\n      let servers = null,\n          pc1 = new RTCPeerConnection(servers),\n          // what is servers??\n      pc2 = new RTCPeerConnection(servers);\n\n      pc1.onicecandidate = e => this.onIceCandidate(pc1, e);\n\n      pc1.oniceconnectionstatechange = e => this.onIceStateChange(pc1, e);\n\n      pc2.onicecandidate = e => this.onIceCandidate(pc2, e);\n\n      pc2.oniceconnectionstatechange = e => this.onIceStateChange(pc2, e);\n\n      pc2.ontrack = this.gotRemoteStream;\n      localStream.getTracks().forEach(track => pc1.addTrack(track, localStream));\n      pc1.createOffer({\n        offerToReceiveAudio: 1,\n        offerToReceiveVideo: 1\n      }).then(this.onCreateOfferSuccess, error => console.error(\"Failed to create session description\", error.toString()));\n      console.log(\"servers after call\", servers);\n      this.setState({\n        servers,\n        pc1,\n        pc2,\n        localStream\n      });\n    };\n\n    this.onCreateOfferSuccess = desc => {\n      let {\n        pc1,\n        pc2\n      } = this.state;\n      pc1.setLocalDescription(desc).then(() => console.log(\"pc1 setLocalDescription complete createOffer\"), error => console.error(\"pc1 Failed to set session description in createOffer\", error.toString()));\n      pc2.setRemoteDescription(desc).then(() => {\n        console.log(\"pc2 setRemoteDescription complete createOffer\");\n        pc2.createAnswer().then(this.onCreateAnswerSuccess, error => console.error(\"pc2 Failed to set session description in createAnswer\", error.toString()));\n      }, error => console.error(\"pc2 Failed to set session description in createOffer\", error.toString()));\n    };\n\n    this.onCreateAnswerSuccess = desc => {\n      let {\n        pc1,\n        pc2\n      } = this.state;\n      pc1.setRemoteDescription(desc).then(() => {\n        console.log(\"pc1 setRemoteDescription complete createAnswer\");\n        console.log(\"servers after createAnswer\", this.state.servers);\n      }, error => console.error(\"pc1 Failed to set session description in onCreateAnswer\", error.toString()));\n      pc2.setLocalDescription(desc).then(() => console.log(\"pc2 setLocalDescription complete createAnswer\"), error => console.error(\"pc2 Failed to set session description in onCreateAnswer\", error.toString()));\n    };\n\n    this.onIceCandidate = (pc, event) => {\n      let {\n        pc1,\n        pc2\n      } = this.state;\n      let otherPc = pc === pc1 ? pc2 : pc1;\n      otherPc.addIceCandidate(event.candidate).then(() => console.log(\"addIceCandidate success\"), error => console.error(\"failed to add ICE Candidate\", error.toString()));\n    };\n\n    this.onIceStateChange = (pc, event) => {\n      console.log(\"ICE state:\", pc.iceConnectionState);\n    };\n\n    this.hangUp = () => {\n      let {\n        pc1,\n        pc2\n      } = this.state;\n      pc1.close();\n      pc2.close();\n      this.setState({\n        pc1: null,\n        pc2: null,\n        hangUpDisabled: true,\n        callDisabled: false\n      });\n    };\n  }\n\n  render() {\n    const {\n      startDisabled,\n      callDisabled,\n      hangUpDisabled\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.localVideoRef,\n      autoPlay: true,\n      muted: true,\n      style: {\n        width: \"240px\",\n        height: \"180px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }\n    }), \" \", /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.remoteVideoRef,\n      autoPlay: true,\n      style: {\n        width: \"240px\",\n        height: \"180px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.start,\n      disabled: startDisabled,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }\n    }, \"Start\", \" \"), \" \", /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.call,\n      disabled: callDisabled,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }\n    }, \"Call\", \" \"), \" \", /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.hangUp,\n      disabled: hangUpDisabled,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }\n    }, \"Hang Up\", \" \"), \" \"), \" \");\n  }\n\n}\n\nexport default PeerConnection;","map":{"version":3,"sources":["/Users/samuelhancak/Documents/WebRTC/web-rtc-audio/src/PeerConnection.jsx"],"names":["React","trace","arg","now","window","performance","toFixed","console","log","PeerConnection","Component","state","startDisabled","callDisabled","hangUpDisabled","servers","pc1","pc2","localStream","localVideoRef","createRef","remoteVideoRef","start","setState","navigator","mediaDevices","getUserMedia","audio","video","then","gotStream","catch","e","alert","name","stream","current","srcObject","gotRemoteStream","event","remoteVideo","streams","call","RTCPeerConnection","onicecandidate","onIceCandidate","oniceconnectionstatechange","onIceStateChange","ontrack","getTracks","forEach","track","addTrack","createOffer","offerToReceiveAudio","offerToReceiveVideo","onCreateOfferSuccess","error","toString","desc","setLocalDescription","setRemoteDescription","createAnswer","onCreateAnswerSuccess","pc","otherPc","addIceCandidate","candidate","iceConnectionState","hangUp","close","render","width","height"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"webrtc-adapter\";\n\n// copied from common.js https://github.com/webrtc/samples/blob/gh-pages/src/js/common.js\nfunction trace(arg) {\n  var now = (window.performance.now() / 1000).toFixed(3);\n  console.log(now + \": \", arg);\n}\n\nclass PeerConnection extends React.Component {\n  state = {\n    startDisabled: false,\n    callDisabled: true,\n    hangUpDisabled: true,\n    servers: null,\n    pc1: null,\n    pc2: null,\n    localStream: null,\n  };\n\n  localVideoRef = React.createRef();\n  remoteVideoRef = React.createRef();\n\n  start = () => {\n    this.setState({\n      startDisabled: true,\n    });\n    navigator.mediaDevices\n      .getUserMedia({\n        audio: true,\n        video: true,\n      })\n      .then(this.gotStream)\n      .catch((e) => alert(\"getUserMedia() error:\" + e.name));\n  };\n  gotStream = (stream) => {\n    this.localVideoRef.current.srcObject = stream;\n    this.setState({\n      callDisabled: false,\n      localStream: stream,\n    });\n  };\n  gotRemoteStream = (event) => {\n    let remoteVideo = this.remoteVideoRef.current;\n\n    if (remoteVideo.srcObject !== event.streams[0]) {\n      remoteVideo.srcObject = event.streams[0];\n    }\n  };\n\n  call = () => {\n    this.setState({\n      callDisabled: true,\n      hangUpDisabled: false,\n    });\n    let { localStream } = this.state;\n\n    // Ah, servers needs to be some sort of iceServer thing\n    // https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer\n    let servers = null,\n      pc1 = new RTCPeerConnection(servers), // what is servers??\n      pc2 = new RTCPeerConnection(servers);\n\n    pc1.onicecandidate = (e) => this.onIceCandidate(pc1, e);\n    pc1.oniceconnectionstatechange = (e) => this.onIceStateChange(pc1, e);\n\n    pc2.onicecandidate = (e) => this.onIceCandidate(pc2, e);\n    pc2.oniceconnectionstatechange = (e) => this.onIceStateChange(pc2, e);\n    pc2.ontrack = this.gotRemoteStream;\n\n    localStream\n      .getTracks()\n      .forEach((track) => pc1.addTrack(track, localStream));\n\n    pc1\n      .createOffer({\n        offerToReceiveAudio: 1,\n        offerToReceiveVideo: 1,\n      })\n      .then(this.onCreateOfferSuccess, (error) =>\n        console.error(\"Failed to create session description\", error.toString())\n      );\n\n    console.log(\"servers after call\", servers);\n\n    this.setState({\n      servers,\n      pc1,\n      pc2,\n      localStream,\n    });\n  };\n\n  onCreateOfferSuccess = (desc) => {\n    let { pc1, pc2 } = this.state;\n\n    pc1.setLocalDescription(desc).then(\n      () => console.log(\"pc1 setLocalDescription complete createOffer\"),\n      (error) =>\n        console.error(\n          \"pc1 Failed to set session description in createOffer\",\n          error.toString()\n        )\n    );\n\n    pc2.setRemoteDescription(desc).then(\n      () => {\n        console.log(\"pc2 setRemoteDescription complete createOffer\");\n        pc2\n          .createAnswer()\n          .then(this.onCreateAnswerSuccess, (error) =>\n            console.error(\n              \"pc2 Failed to set session description in createAnswer\",\n              error.toString()\n            )\n          );\n      },\n      (error) =>\n        console.error(\n          \"pc2 Failed to set session description in createOffer\",\n          error.toString()\n        )\n    );\n  };\n\n  onCreateAnswerSuccess = (desc) => {\n    let { pc1, pc2 } = this.state;\n\n    pc1.setRemoteDescription(desc).then(\n      () => {\n        console.log(\"pc1 setRemoteDescription complete createAnswer\");\n        console.log(\"servers after createAnswer\", this.state.servers);\n      },\n      (error) =>\n        console.error(\n          \"pc1 Failed to set session description in onCreateAnswer\",\n          error.toString()\n        )\n    );\n\n    pc2.setLocalDescription(desc).then(\n      () => console.log(\"pc2 setLocalDescription complete createAnswer\"),\n      (error) =>\n        console.error(\n          \"pc2 Failed to set session description in onCreateAnswer\",\n          error.toString()\n        )\n    );\n  };\n\n  onIceCandidate = (pc, event) => {\n    let { pc1, pc2 } = this.state;\n\n    let otherPc = pc === pc1 ? pc2 : pc1;\n\n    otherPc.addIceCandidate(event.candidate).then(\n      () => console.log(\"addIceCandidate success\"),\n      (error) => console.error(\"failed to add ICE Candidate\", error.toString())\n    );\n  };\n\n  onIceStateChange = (pc, event) => {\n    console.log(\"ICE state:\", pc.iceConnectionState);\n  };\n\n  hangUp = () => {\n    let { pc1, pc2 } = this.state;\n\n    pc1.close();\n    pc2.close();\n\n    this.setState({\n      pc1: null,\n      pc2: null,\n      hangUpDisabled: true,\n      callDisabled: false,\n    });\n  };\n\n  render() {\n    const { startDisabled, callDisabled, hangUpDisabled } = this.state;\n\n    return (\n      <div>\n        <video\n          ref={this.localVideoRef}\n          autoPlay\n          muted\n          style={{\n            width: \"240px\",\n            height: \"180px\",\n          }}\n        />{\" \"}\n        <video\n          ref={this.remoteVideoRef}\n          autoPlay\n          style={{\n            width: \"240px\",\n            height: \"180px\",\n          }}\n        />\n        <div>\n          <button onClick={this.start} disabled={startDisabled}>\n            Start{\" \"}\n          </button>{\" \"}\n          <button onClick={this.call} disabled={callDisabled}>\n            Call{\" \"}\n          </button>{\" \"}\n          <button onClick={this.hangUp} disabled={hangUpDisabled}>\n            Hang Up{\" \"}\n          </button>{\" \"}\n        </div>{\" \"}\n      </div>\n    );\n  }\n}\n\nexport default PeerConnection;\n"]},"metadata":{},"sourceType":"module"}